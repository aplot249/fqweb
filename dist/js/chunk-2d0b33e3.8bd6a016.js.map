{"version":3,"sources":["webpack:///./src/views/User/UserLogin.vue","webpack:///./src/views/User/UserLogin.vue?6923"],"names":["class","id","type","loginInfo","username","placeholder","password","verify","ref","changeModalShow","href","btnClick","$emit","components","vueImgVerify","emits","setup","prop","emit","verifyRef","store","router","value","imgCode","toLowerCase","test","then","res","console","log","data","is_active","push","localStorage","setItem","JSON","stringify","commit","alert","err","response","status","render"],"mappings":"0IACSA,MAAM,Q,EACP,eAAa,UAAT,QAAI,G,EAEA,eAAiB,YAAX,QAAI,G,EACV,eAAgB,YAAV,OAAG,G,EAET,eAAiB,YAAX,QAAI,G,GAITC,GAAG,Q,GAIPA,GAAG,U,8FAdZ,eAkBM,MAlBN,EAkBM,CAjBF,EACA,eAWK,WAVD,eAAkG,WAA9F,E,eAAiB,eAAwE,SAAjEC,KAAK,O,qDAAgB,EAAAC,UAAUC,SAAQ,IAAEC,YAAY,a,mBAAhC,EAAAF,UAAUC,cAC3D,eAAqG,WAAjG,E,eAAgB,eAA4E,SAArEF,KAAK,W,qDAAoB,EAAAC,UAAUG,SAAQ,IAAED,YAAY,a,mBAAhC,EAAAF,UAAUG,cAC9D,eAIM,YAHF,E,eACA,eAAkE,SAA3DJ,KAAK,O,qDAAgB,EAAAC,UAAUI,OAAM,IAAEF,YAAY,S,mBAA9B,EAAAF,UAAUI,UACtC,eAAiC,GAAjBC,IAAI,aAAW,YAEnC,eAEM,MAFN,EAEM,CADF,eAA+D,KAA3D,QAAK,8BAAE,EAAAC,iBAAA,EAAAA,gBAAA,qBAAiBC,KAAK,sBAAqB,aAG9D,eAGM,MAHN,EAGM,CAFF,eAAqC,UAA5B,QAAK,8BAAE,EAAAC,UAAA,EAAAA,SAAA,sBAAU,MAC1B,eAAqE,UAA5D,QAAK,iCAAOC,MAAK,8BAA6B,a,oDAYhD,GACXC,WAAY,CACRC,aAAA,QAEJC,MAAO,CACH,eACA,mBAEJC,MARW,SAQLC,EARK,GAQS,IAAPC,EAAO,EAAPA,KACHC,EAAY,eAAI,MAChBC,EAAQ,iBACVC,EAAS,iBAETlB,GADQ,iBACI,eAAS,CACrBC,SAAU,GACVE,SAAU,GACVC,OAAQ,MAERE,EAAkB,WAClBS,EAAK,oBAELP,EAAW,WACPQ,EAAUG,MAAMC,QAAQC,gBAAkBrB,EAAUI,OAAOiB,cAI1D,qBAAqBC,KAAKtB,EAAUC,UAIpC,oBAAoBqB,KAAKtB,EAAUG,UAIxC,eAAK,eAAgB,CAAC,SAAYH,EAAUC,SAAU,SAAYD,EAAUG,WAAWoB,MACnF,SAAAC,GACIC,QAAQC,IAAIF,EAAIG,MACZH,EAAIG,KAAKC,WACTV,EAAOW,KAAK,YACZC,aAAaC,QAAQ,WAAYC,KAAKC,UAAUT,EAAIG,OACpDV,EAAMiB,OAAO,qBAAqB,IAElCC,MAAM,qBAGd,SAAAC,GAC8B,OAAvBA,EAAIC,SAASC,QACZH,MAAM,mBAhBdA,MAAM,UAJNA,MAAM,WAJNA,MAAM,UA6Bd,MAAO,CAACnC,YAAWQ,WAASF,kBAAgBU,eC9ExD,EAAOuB,OAASA,EAED","file":"js/chunk-2d0b33e3.8bd6a016.js","sourcesContent":["<template>\r\n    <div class=\"form\">\r\n        <h2>用户登录</h2>\r\n        <ul>\r\n            <li><span>用户名：</span><input type=\"text\" v-model=\"loginInfo.username\" placeholder=\"输入用户名或邮箱号\"></li>\r\n            <li><span>密码：</span><input type=\"password\" v-model=\"loginInfo.password\" placeholder=\"密码（5-15位）\"></li>\r\n            <div>\r\n                <span>验证码：</span>\r\n                <input type=\"text\" v-model=\"loginInfo.verify\" placeholder=\"输入验证码\">\r\n                <vue-img-verify ref=\"verifyRef\"/>\r\n            </div>\r\n            <div id=\"fpwd\">\r\n                <a @click=\"changeModalShow\" href=\"javascript:void(0)\">忘记密码？</a>\r\n            </div>\r\n        </ul>\r\n        <div id=\"action\">\r\n            <button @click=\"btnClick\">登录</button>\r\n            <button @click=\"this.$emit('changeStatus','register')\">新用户注册</button>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    import {ref, reactive, onMounted} from \"vue\";\r\n    import {useRoute, useRouter} from \"vue-router\";\r\n    import {useStore} from \"vuex\";\r\n    import vueImgVerify from \"@/components/Captcha.vue\"\r\n    import {get, post} from \"@/network\";\r\n\r\n    export default {\r\n        components: {\r\n            vueImgVerify,\r\n        },\r\n        emits: [\r\n            'changeStatus',\r\n            'changeModalShow'\r\n        ],\r\n        setup(prop, {emit}) {\r\n            const verifyRef = ref(null)\r\n            const store = useStore()\r\n            let router = useRouter()\r\n            let route = useRoute()\r\n            let loginInfo = reactive({\r\n                username: '',\r\n                password: '',\r\n                verify: ''\r\n            })\r\n            let changeModalShow = ()=>{\r\n                emit('changeModalShow')\r\n            }\r\n            let btnClick = () => {\r\n                if (verifyRef.value.imgCode.toLowerCase() !== loginInfo.verify.toLowerCase()) {\r\n                    alert(\"验证码错误\")\r\n                    return;\r\n                }\r\n                if (!/[0-9a-zA-Z_]{5,15}/.test(loginInfo.username)) {\r\n                    alert(\"用户名格式不符\")\r\n                    return;\r\n                }\r\n                if (!/[0-9a-zA-Z]{5,15}/.test(loginInfo.password)) {\r\n                    alert(\"密码格式不符\")\r\n                    return;\r\n                }\r\n                post('/user/token/', {'username': loginInfo.username, 'password': loginInfo.password}).then(\r\n                    res => {\r\n                        console.log(res.data)\r\n                        if (res.data.is_active) {\r\n                            router.push('/backend')\r\n                            localStorage.setItem('userinfo', JSON.stringify(res.data))\r\n                            store.commit('changeLoginStatus', true)\r\n                        }else {\r\n                            alert(\"邮箱没有激活，请先激活再登录\")\r\n                        }\r\n                    },\r\n                    err=>{\r\n                        if(err.response.status == '400'){\r\n                            alert(\"用户名或密码错误，请重试\")\r\n                        }\r\n                    }\r\n                )\r\n            }\r\n            return {loginInfo, btnClick,changeModalShow,verifyRef}\r\n        }\r\n    }\r\n</script>\r\n\r\n<style>\r\n\r\n</style>","import { render } from \"./UserLogin.vue?vue&type=template&id=4d961e6c\"\nimport script from \"./UserLogin.vue?vue&type=script&lang=js\"\nexport * from \"./UserLogin.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script"],"sourceRoot":""}